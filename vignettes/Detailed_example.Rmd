---
title: "Unique External Characteristics with Non-Unique Internal Characteristics"
author: "Bernd Funovits"
date: "`18 June 2017`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Uniqueness et al.}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(indeterminateR)
library(tidyverse)
```


This vignette analyzes a modified verison of the model by [Lubik and Marzo (2007)]{https://doi.org/10.1016/j.iref.2004.09.008}. 
In particular, it uses equation (26) with \code{i = 0}.

The first section introduces the workings/functions of the package and can be skipped if one is only interested in verifying the results in the paper.
The second section verifies that the uniqueness condition in [Sims (2001)]{https://doi.org/10.1023/A:1020517101123} is satisfied even though the existence condition has multiple solutions.
The internal (indeterminate) characteristics are thus not identifiable from the external characteristics.

## The Package

The main function is "evaluate_my_model".

```{r explain evaluate}
?evaluate_my_model
```

Its inputs are 
* deep structural parameters, given as a list, and 
* a model, given as a string. 

In our case, we consider the model "Lubik_Marzo_26_0". 
Its deep parameters can be inspected in its help-file.

```{r explain linear_model_LM}
?linear_parameters_LM_26_0
```

The outputs of "evaluate_my_model" are functions of the matrices in Sims' canonical form.
They are described in the help file of "evaluate_my_model" shown above.

## Verification of Statements in the Paper

The input parameter "verbose" in "evaluate_my_model" is set to "TRUE".
In this way, the functions prints
* the linear parameter in Sims' canonical form,
* the orthogonal matrices describing the stable and unstable subspaces,
* the generalized eigenvalues in the QZ decomposition, and
* the matrices used in the existence and uniqueness condition.

Finally, the results for existence and uniqueness are given.
The boolean values for the existence and uniqueness condition indicate that both are satisfied.
Even though the dimension of the kernel in the existence condition is one, the dimension of indeterminacy is zero.

```{r Run the example}
results <- evaluate_my_model(deep_params = list(s = 1.5, 
                                     b = 0.99, 
                                     k = 1/1.5, 
                                     f_y = -1.3/1.5, 
                                     f_p = 1.3, 
                                     f_r = 0.6), 
                  my_model = "Lubik_Marzo_26_0", verbose = TRUE)
t(results)
```
